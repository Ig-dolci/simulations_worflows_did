from matplotlib import pyplot as plt
import numpy as np
# Use latex for the labels
plt.rc('text', usetex=True)
#  Acoustic wave equation
res_acoustic = [0.008843686071462242, 0.0022859710462416194, 0.0005808762499689979, 0.00014639376894151623, 3.6746270082585464e-05, 9.205549233469446e-06, 2.3040122842481192e-06, 5.764575297991653e-07, 1.4423422860492668e-07, 3.610505341358414e-08]
rates_acoustic = [1.9518406833157023, 1.9765043813729446, 1.9883766957192375, 1.994184426276359, 1.9970221119138754, 1.998355391309888, 1.9988621816661691, 1.9988007470332037, 1.9981408930103863]
epsilon = [0.01,0.005,0.0025,0.00125,0.000625,0.0003125,0.00015625,7.8125e-05, 3.90625e-05, 1.953125e-05]


# Elastic wave equation
res_vs = [1.150488369345646, 0.21063779257683157, 0.04597294988626405, 0.011041552460251984, 0.002731621940981046, 0.0006811005722679242, 0.00017016237365604148, 4.253353485126648e-05, 1.0632999458128205e-05, 2.65820865024767e-06]
rates_vs = [2.4494101863092617, 2.195907161782015, 2.057842209005134, 2.0151132994288483, 2.0038180776501835, 2.0009557811221454, 2.0002393995377306, 2.000052135083716, 2.000022368139816]
res_vp = [0.07830597972268238, 0.01962051083409322, 0.004910579973402496, 0.001228323386399277, 0.00030716544144640534, 7.680196092420266e-05, 1.9201855353707942e-05, 4.800634107991059e-06, 1.2001512747928517e-06, 3.000656747459765e-07]
rates_vp = [1.9967598773916106, 1.9983972716860159, 1.999202991113382, 1.999602620092946, 1.9998008588004763, 1.9998974304481303, 1.9999488293824106, 2.000008717808056, 1.9998660638292056]

# Print epsilon vs residual, the line of order 2 as the reference
plt.figure()
# plt.loglog(epsilon, res_vs, '-o', label='$v_s$', color='blue')
plt.loglog(epsilon, res_acoustic, '-o', label='$v_p$', color='red')
# Make the line of order 2 on top of the residual
plt.loglog(epsilon, [100*epsilon[i]**2 for i in range(len(epsilon))], '--', label=r'$O(2)$', color='black')
# plt.loglog(epsilon, [1000*epsilon[i]**2 for i in range(len(epsilon))], '--', color='black')

# Invert the x-axis
plt.gca().invert_xaxis()
# Increase the font size
plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.xlabel(r'$\epsilon$', fontsize=16)
plt.ylabel(r'Residual', fontsize=16)
plt.legend(fontsize=14)
plt.grid()
plt.show()